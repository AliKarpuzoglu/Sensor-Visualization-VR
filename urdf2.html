<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />

  <script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
<script src="https://static.robotwebtools.org/threejs/current/three.min.js"></script>
<script src="STLLoader.js"></script>
<script src="https://static.robotwebtools.org/EventEmitter2/current/eventemitter2.min.js"></script>
<script src="https://static.robotwebtools.org/roslibjs/current/roslib.min.js"></script>
<script src="https://static.robotwebtools.org/ros3djs/current/ros3d.min.js"></script>

<script>
	var viewer;
  /**
   * Setup all visualization elements when the page is loaded.
   */
  function init() {
    // Connect to ROS.
    var ros = new ROSLIB.Ros({
      url : 'ws://192.168.2.115:9090'
    });

    // Create the main viewer.
/*     viewer = new ROS3D.Viewer({
      divID : 'urdf',
      width : 800,
      height : 600,
      antialias : true
    });

    // Add a grid.
    viewer.addObject(new ROS3D.Grid());
*/
    // Setup a client to listen to TFs.
    var tfClient = new ROSLIB.TFClient({
      ros : ros,
      angularThres : 0.01,
      transThres : 0.01,
      rate : 10.0,
     fixedFrame: '/world' 
    });

    // Setup the URDF client.
    var urdfClient = new ROS3D.UrdfClient({
      ros : ros,
      tfClient : tfClient,
      path : 'http://192.168.2.115:8080/',
      // rootObject : viewer.scene
      rootObject : AFRAME.scenes[0].object3D
    });
    console.log(urdfClient)
  // do{
      // var robot = urdfClient.that
      // console.log(urdfClient)

          window.addEventListener(' change',function(){
console.log('change')
      },false)
 setTimeout(function(){ let scene_elements = AFRAME.scenes[0].object3D.children

var robot = scene_elements[scene_elements.length-1] //last element is the robot

       // }while(robot==undefined)
 console.log(robot)
 robot.lookAt(0,1,0); // make it look up
},2000)

  };
 
</script>
</head>

<body onload="init()">
  <a-scene   id="main" >
	  <a-entity vive-controls="hand: left"></a-entity>
	  <a-entity vive-controls="hand: right"></a-entity>

	      <a-box position="-1 0.5 -3" rotation="0 45 0" color="#4CC3D9"></a-box>
  
      <a-plane position="0 0 0" rotation="-90 0 0" width="4" height="4" color="#7BC8A4"></a-plane>
      <a-sky color="#ECECEC"></a-sky>
	
</a-scene>
</body>
</html>

